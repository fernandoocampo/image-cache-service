package resizers_test

import (
	"context"
	"net/http"
	"net/http/httptest"
	"testing"
	"time"

	"github.com/esadikov/interview-fm-backend/internal/resizers"
	lru "github.com/hashicorp/golang-lru"
	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"
)

func TestGetImageInCache(t *testing.T) {
	// Given
	ctx, cancel := context.WithTimeout(context.TODO(), 5*time.Second)
	defer cancel()

	key := "/v1/image/ROTm3h7JoDi_3H92HK3pIkCcWtedRl6NjTDKM7J4hkY=.jpeg"
	want := []byte("anyimagevalue")

	cache := newCache(t)

	cache.Add(key, []byte("anyimagevalue"))

	setup := resizers.ServiceSetup{
		Cache: cache,
	}
	service := resizers.NewService(&setup)

	// When
	got, err := service.GetImage(ctx, key)
	// Then
	require.NoError(t, err)
	assert.Equal(t, want, got)
}

func TestResizeImageSync(t *testing.T) {
	// Given
	imageHTTPServer := newDummyImageServer(t)
	defer imageHTTPServer.Close()

	cache := newCache(t)

	setup := resizers.ServiceSetup{
		Cache: cache,
	}
	service := resizers.NewService(&setup)

	request := resizers.ResizeRequest{
		Async:  false,
		URLs:   []string{imageHTTPServer.URL + "/image.jpeg"},
		Width:  10,
		Height: 0,
	}

	want := []resizers.ResizeResult{
		{
			Cached: false,
			Result: "success",
		},
	}

	// When
	got, err := service.ProcessResizes(request)

	// Then
	require.NoError(t, err)
	want[0].URL = got[0].URL
	assert.Equal(t, want, got)
}

func TestResizeImageAsync(t *testing.T) {
	// Given
	ctx, cancel := context.WithTimeout(context.TODO(), 25*time.Second)
	defer cancel()

	imageHTTPServer := newDummyImageServer(t)
	defer imageHTTPServer.Close()

	cache := newCache(t)

	setup := resizers.ServiceSetup{
		Cache: cache,
	}
	service := resizers.NewService(&setup)
	// service.StartWorkerHandler(ctx)
	service.StartCacheEviction(ctx)

	request := resizers.ResizeRequest{
		Async:  true,
		URLs:   []string{imageHTTPServer.URL + "/image.jpeg"},
		Width:  10,
		Height: 0,
	}

	want := []resizers.ResizeResult{
		{
			Cached: false,
			Result: "in-progress",
		},
	}

	// When
	processGot, processErr := service.ProcessResizes(request)
	imageGot, imageErr := service.GetImage(ctx, processGot[0].URL[21:])

	// Then
	require.NoError(t, processErr)
	want[0].URL = processGot[0].URL
	assert.Equal(t, want, processGot)

	t.Log(processGot[0].URL[21:])
	require.NoError(t, imageErr)
	assert.NotEmpty(t, imageGot)
	assert.Equal(t, 1, len(cache.Keys()))

	time.Sleep(5 * time.Second)
	assert.Equal(t, 0, len(cache.Keys()))
}

func newCache(t *testing.T) *lru.Cache {
	t.Helper()

	cache, err := lru.New(1024)
	require.NoError(t, err)

	return cache
}

func newDummyImageServer(t *testing.T) *httptest.Server {
	t.Helper()

	router := http.NewServeMux()
	router.Handle("/image.jpeg", newDummyImageHandler(t))
	return httptest.NewServer(router)
}

func newDummyImageHandler(t *testing.T) http.HandlerFunc {
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		t.Helper()
		w.Write(imageFixutre())
	})
}

func imageFixutre() []byte {
	return []byte{255, 216, 255, 219, 0, 132, 0, 8, 6, 6, 7, 6, 5, 8, 7, 7, 7, 9, 9, 8, 10, 12, 20, 13, 12, 11, 11, 12, 25, 18, 19, 15, 20, 29, 26, 31, 30, 29, 26, 28, 28, 32, 36, 46, 39, 32, 34, 44, 35, 28, 28, 40, 55, 41, 44, 48, 49, 52, 52, 52, 31, 39, 57, 61, 56, 50, 60, 46, 51, 52, 50, 1, 9, 9, 9, 12, 11, 12, 24, 13, 13, 24, 50, 33, 28, 33, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 255, 192, 0, 17, 8, 0, 80, 0, 200, 3, 1, 34, 0, 2, 17, 1, 3, 17, 1, 255, 196, 1, 162, 0, 0, 1, 5, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 16, 0, 2, 1, 3, 3, 2, 4, 3, 5, 5, 4, 4, 0, 0, 1, 125, 1, 2, 3, 0, 4, 17, 5, 18, 33, 49, 65, 6, 19, 81, 97, 7, 34, 113, 20, 50, 129, 145, 161, 8, 35, 66, 177, 193, 21, 82, 209, 240, 36, 51, 98, 114, 130, 9, 10, 22, 23, 24, 25, 26, 37, 38, 39, 40, 41, 42, 52, 53, 54, 55, 56, 57, 58, 67, 68, 69, 70, 71, 72, 73, 74, 83, 84, 85, 86, 87, 88, 89, 90, 99, 100, 101, 102, 103, 104, 105, 106, 115, 116, 117, 118, 119, 120, 121, 122, 131, 132, 133, 134, 135, 136, 137, 138, 146, 147, 148, 149, 150, 151, 152, 153, 154, 162, 163, 164, 165, 166, 167, 168, 169, 170, 178, 179, 180, 181, 182, 183, 184, 185, 186, 194, 195, 196, 197, 198, 199, 200, 201, 202, 210, 211, 212, 213, 214, 215, 216, 217, 218, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 1, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 17, 0, 2, 1, 2, 4, 4, 3, 4, 7, 5, 4, 4, 0, 1, 2, 119, 0, 1, 2, 3, 17, 4, 5, 33, 49, 6, 18, 65, 81, 7, 97, 113, 19, 34, 50, 129, 8, 20, 66, 145, 161, 177, 193, 9, 35, 51, 82, 240, 21, 98, 114, 209, 10, 22, 36, 52, 225, 37, 241, 23, 24, 25, 26, 38, 39, 40, 41, 42, 53, 54, 55, 56, 57, 58, 67, 68, 69, 70, 71, 72, 73, 74, 83, 84, 85, 86, 87, 88, 89, 90, 99, 100, 101, 102, 103, 104, 105, 106, 115, 116, 117, 118, 119, 120, 121, 122, 130, 131, 132, 133, 134, 135, 136, 137, 138, 146, 147, 148, 149, 150, 151, 152, 153, 154, 162, 163, 164, 165, 166, 167, 168, 169, 170, 178, 179, 180, 181, 182, 183, 184, 185, 186, 194, 195, 196, 197, 198, 199, 200, 201, 202, 210, 211, 212, 213, 214, 215, 216, 217, 218, 226, 227, 228, 229, 230, 231, 232, 233, 234, 242, 243, 244, 245, 246, 247, 248, 249, 250, 255, 218, 0, 12, 3, 1, 0, 2, 17, 3, 17, 0, 63, 0, 245, 154, 40, 170, 119, 186, 173, 142, 156, 84, 93, 220, 164, 69, 129, 32, 16, 73, 192, 234, 112, 59, 123, 215, 164, 120, 5, 202, 43, 58, 231, 89, 180, 129, 188, 184, 216, 220, 77, 128, 68, 80, 124, 199, 7, 161, 39, 162, 143, 114, 107, 155, 212, 225, 214, 117, 91, 232, 174, 147, 80, 26, 114, 194, 1, 142, 56, 71, 152, 192, 231, 36, 177, 56, 83, 158, 152, 193, 226, 154, 82, 127, 10, 185, 50, 156, 33, 241, 59, 29, 173, 21, 201, 68, 53, 168, 121, 254, 221, 146, 86, 244, 150, 218, 50, 191, 144, 0, 254, 181, 165, 103, 174, 48, 157, 45, 117, 36, 72, 101, 126, 35, 153, 15, 238, 165, 62, 156, 242, 173, 236, 122, 246, 38, 170, 80, 148, 117, 104, 152, 86, 132, 221, 162, 205, 186, 40, 237, 156, 81, 82, 104, 20, 81, 92, 191, 139, 53, 251, 141, 35, 203, 142, 25, 18, 16, 209, 151, 46, 216, 220, 231, 56, 218, 155, 184, 207, 126, 115, 244, 164, 7, 81, 71, 56, 206, 43, 205, 180, 207, 24, 106, 87, 81, 77, 29, 214, 163, 20, 80, 137, 62, 73, 252, 129, 246, 130, 189, 212, 168, 202, 130, 14, 70, 236, 115, 233, 91, 112, 53, 158, 162, 158, 114, 92, 27, 192, 14, 11, 52, 204, 248, 62, 132, 103, 0, 251, 98, 174, 17, 115, 216, 202, 173, 85, 75, 116, 117, 102, 104, 148, 225, 165, 140, 31, 66, 192, 83, 253, 251, 87, 46, 44, 237, 87, 56, 182, 131, 147, 147, 251, 181, 231, 244, 170, 183, 87, 201, 99, 41, 134, 205, 175, 62, 216, 0, 111, 179, 216, 68, 100, 108, 30, 132, 160, 5, 113, 245, 197, 84, 169, 56, 171, 182, 103, 79, 18, 167, 46, 84, 153, 217, 81, 94, 121, 123, 227, 13, 82, 199, 203, 77, 106, 207, 80, 211, 137, 117, 72, 221, 32, 17, 172, 153, 234, 204, 205, 144, 184, 254, 238, 123, 119, 174, 207, 68, 189, 151, 81, 209, 173, 111, 38, 140, 163, 204, 165, 128, 43, 140, 174, 78, 214, 199, 108, 140, 28, 123, 214, 42, 73, 236, 117, 56, 181, 186, 52, 51, 73, 75, 81, 203, 42, 67, 27, 73, 35, 5, 69, 25, 36, 244, 21, 66, 36, 163, 175, 74, 195, 151, 196, 112, 201, 112, 246, 150, 113, 76, 215, 33, 67, 102, 88, 153, 17, 65, 232, 196, 158, 190, 195, 169, 253, 106, 165, 196, 6, 244, 15, 182, 75, 36, 220, 96, 141, 229, 87, 254, 249, 7, 21, 80, 131, 158, 168, 198, 173, 104, 210, 118, 150, 230, 222, 165, 168, 69, 166, 88, 201, 117, 50, 179, 42, 1, 133, 81, 203, 18, 112, 0, 247, 36, 138, 93, 58, 254, 61, 74, 194, 43, 184, 129, 85, 124, 130, 164, 228, 169, 4, 130, 63, 48, 107, 151, 147, 66, 211, 228, 93, 190, 65, 94, 65, 249, 100, 97, 200, 228, 30, 181, 37, 148, 55, 186, 60, 11, 14, 157, 115, 186, 16, 236, 222, 85, 200, 223, 212, 228, 225, 184, 35, 147, 239, 84, 232, 205, 17, 28, 93, 55, 228, 117, 244, 87, 41, 117, 227, 33, 104, 173, 3, 216, 183, 219, 194, 150, 88, 195, 254, 236, 168, 234, 197, 255, 0, 133, 71, 124, 143, 166, 107, 87, 195, 250, 188, 154, 205, 132, 147, 203, 12, 113, 60, 114, 180, 68, 69, 38, 244, 108, 0, 114, 14, 7, 173, 101, 214, 199, 74, 213, 93, 26, 212, 81, 69, 48, 16, 215, 13, 173, 91, 220, 222, 248, 196, 253, 150, 229, 163, 138, 40, 35, 243, 200, 61, 24, 49, 101, 95, 112, 65, 108, 143, 76, 26, 238, 186, 241, 92, 118, 148, 165, 210, 234, 237, 190, 253, 213, 204, 146, 31, 160, 109, 171, 250, 40, 170, 167, 30, 105, 35, 26, 245, 57, 41, 183, 223, 66, 123, 59, 56, 108, 45, 196, 16, 12, 70, 9, 35, 32, 103, 147, 250, 250, 125, 5, 72, 94, 71, 185, 138, 214, 222, 38, 154, 230, 92, 236, 141, 125, 7, 82, 79, 96, 61, 106, 74, 212, 240, 124, 74, 250, 206, 173, 112, 220, 186, 36, 48, 175, 178, 144, 88, 254, 100, 143, 202, 183, 175, 83, 217, 83, 188, 78, 76, 37, 31, 172, 214, 229, 147, 243, 98, 71, 225, 93, 82, 68, 45, 45, 237, 188, 76, 71, 202, 137, 17, 112, 62, 164, 145, 159, 210, 178, 47, 172, 222, 57, 165, 210, 181, 56, 227, 102, 116, 44, 165, 126, 236, 169, 208, 145, 232, 65, 199, 29, 184, 34, 187, 31, 20, 29, 92, 120, 102, 253, 180, 44, 127, 105, 136, 137, 128, 28, 114, 222, 131, 60, 103, 25, 198, 123, 215, 2, 239, 174, 219, 120, 51, 195, 215, 30, 40, 31, 241, 58, 58, 143, 151, 131, 130, 226, 55, 44, 54, 177, 28, 100, 47, 95, 165, 121, 244, 177, 51, 115, 74, 78, 233, 158, 206, 35, 1, 73, 82, 110, 154, 179, 69, 221, 2, 198, 193, 224, 159, 76, 1, 173, 181, 59, 101, 12, 151, 104, 199, 124, 138, 120, 87, 60, 252, 196, 30, 24, 28, 131, 248, 213, 175, 13, 235, 23, 218, 172, 119, 241, 106, 58, 127, 216, 238, 172, 110, 141, 179, 237, 109, 201, 41, 0, 29, 200, 79, 110, 122, 118, 174, 78, 125, 27, 196, 26, 198, 166, 215, 218, 117, 172, 200, 70, 99, 177, 188, 251, 79, 151, 28, 99, 63, 51, 50, 142, 88, 110, 95, 124, 129, 210, 186, 255, 0, 15, 205, 115, 115, 30, 163, 61, 212, 73, 20, 205, 125, 34, 178, 70, 219, 151, 42, 21, 73, 7, 3, 32, 144, 77, 10, 81, 246, 174, 49, 122, 4, 163, 39, 66, 51, 154, 213, 155, 53, 131, 175, 218, 157, 90, 123, 61, 37, 129, 54, 243, 111, 154, 235, 3, 44, 98, 65, 146, 171, 238, 196, 129, 244, 38, 183, 171, 10, 235, 84, 58, 95, 141, 52, 217, 165, 92, 89, 125, 158, 68, 184, 148, 244, 140, 49, 80, 172, 125, 178, 57, 61, 129, 171, 169, 126, 87, 98, 40, 219, 218, 43, 146, 124, 60, 241, 158, 159, 226, 73, 117, 29, 50, 199, 71, 254, 206, 77, 52, 170, 133, 4, 96, 131, 158, 192, 12, 17, 142, 71, 53, 177, 226, 141, 50, 31, 179, 255, 0, 106, 194, 136, 151, 48, 97, 100, 96, 49, 230, 68, 88, 101, 79, 211, 168, 61, 177, 238, 107, 118, 222, 11, 104, 131, 73, 109, 20, 75, 230, 157, 204, 209, 168, 249, 207, 169, 35, 173, 115, 126, 49, 214, 160, 134, 197, 244, 168, 156, 61, 212, 227, 50, 42, 243, 229, 68, 14, 89, 155, 29, 56, 24, 30, 166, 185, 41, 115, 115, 171, 110, 122, 24, 133, 31, 101, 37, 45, 172, 96, 220, 204, 45, 173, 166, 152, 140, 136, 145, 156, 143, 92, 12, 215, 99, 225, 139, 4, 211, 252, 63, 106, 163, 153, 230, 141, 102, 158, 78, 242, 72, 192, 18, 79, 242, 30, 128, 10, 243, 219, 139, 29, 121, 236, 229, 154, 91, 59, 165, 80, 25, 174, 34, 145, 81, 98, 16, 224, 147, 181, 186, 150, 219, 239, 215, 174, 43, 179, 240, 238, 191, 102, 154, 69, 149, 165, 245, 212, 80, 93, 69, 10, 166, 101, 59, 22, 80, 0, 1, 148, 158, 14, 70, 56, 234, 43, 167, 19, 90, 53, 163, 120, 108, 143, 63, 1, 134, 150, 26, 109, 84, 221, 237, 250, 153, 112, 120, 214, 207, 91, 241, 245, 255, 0, 131, 39, 211, 55, 199, 28, 46, 90, 70, 59, 129, 199, 80, 203, 142, 1, 7, 143, 254, 189, 88, 210, 49, 29, 172, 182, 129, 217, 197, 148, 242, 90, 134, 99, 146, 66, 31, 151, 39, 232, 64, 252, 42, 206, 167, 226, 63, 15, 105, 87, 79, 115, 106, 144, 94, 234, 183, 10, 0, 75, 53, 87, 150, 64, 58, 110, 97, 209, 125, 201, 197, 102, 120, 94, 57, 6, 134, 179, 207, 255, 0, 31, 23, 115, 75, 115, 54, 14, 70, 247, 115, 144, 61, 128, 0, 15, 165, 103, 65, 59, 223, 161, 213, 139, 148, 109, 110, 166, 209, 174, 103, 85, 214, 44, 45, 181, 89, 91, 82, 184, 142, 27, 91, 8, 146, 95, 222, 54, 3, 72, 217, 193, 199, 124, 5, 56, 247, 62, 213, 210, 154, 227, 181, 77, 19, 76, 214, 60, 107, 25, 186, 189, 54, 55, 48, 219, 143, 40, 171, 5, 51, 100, 176, 35, 230, 4, 54, 7, 110, 191, 53, 107, 90, 124, 145, 185, 205, 66, 28, 243, 176, 237, 50, 230, 27, 235, 49, 169, 70, 234, 255, 0, 107, 253, 235, 56, 32, 245, 232, 51, 236, 56, 252, 43, 111, 68, 208, 230, 214, 160, 91, 235, 137, 165, 183, 178, 126, 97, 72, 240, 30, 85, 254, 241, 39, 238, 131, 216, 14, 113, 207, 21, 200, 157, 57, 52, 125, 23, 91, 211, 244, 217, 141, 212, 80, 137, 12, 78, 160, 101, 157, 148, 179, 46, 71, 4, 130, 113, 197, 122, 182, 135, 44, 19, 232, 26, 116, 182, 204, 26, 221, 173, 162, 49, 145, 253, 221, 163, 21, 85, 107, 181, 74, 60, 154, 92, 207, 11, 132, 132, 177, 21, 29, 77, 108, 204, 169, 252, 31, 6, 75, 218, 95, 93, 66, 255, 0, 221, 145, 252, 212, 63, 80, 220, 254, 68, 87, 58, 190, 106, 188, 176, 220, 71, 229, 79, 11, 152, 228, 76, 228, 3, 234, 15, 112, 65, 4, 31, 122, 189, 225, 109, 43, 198, 214, 190, 51, 213, 175, 53, 237, 78, 57, 180, 105, 3, 139, 88, 21, 247, 114, 95, 42, 113, 143, 151, 11, 199, 189, 69, 171, 220, 69, 63, 138, 245, 20, 135, 39, 201, 142, 24, 229, 61, 188, 204, 49, 199, 215, 105, 92, 253, 69, 44, 37, 105, 185, 242, 183, 116, 86, 103, 133, 164, 169, 123, 72, 171, 52, 98, 234, 250, 45, 190, 171, 107, 44, 108, 168, 178, 184, 3, 121, 92, 244, 233, 145, 220, 2, 115, 131, 198, 107, 83, 194, 178, 199, 111, 100, 116, 130, 187, 110, 44, 212, 22, 56, 255, 0, 90, 164, 156, 73, 245, 56, 231, 223, 234, 40, 53, 74, 2, 209, 248, 195, 78, 41, 210, 88, 102, 73, 62, 128, 6, 254, 96, 87, 101, 104, 43, 115, 30, 94, 22, 172, 147, 228, 123, 29, 117, 20, 10, 43, 156, 244, 4, 53, 200, 105, 89, 138, 27, 139, 54, 251, 214, 151, 50, 194, 126, 155, 183, 41, 252, 85, 133, 118, 21, 203, 106, 81, 181, 151, 138, 18, 69, 83, 228, 234, 16, 225, 143, 97, 44, 125, 63, 53, 39, 254, 249, 21, 116, 165, 203, 52, 97, 137, 135, 53, 55, 229, 169, 98, 150, 210, 254, 235, 72, 191, 107, 203, 104, 204, 241, 200, 129, 38, 183, 200, 27, 192, 60, 50, 158, 204, 50, 125, 142, 126, 148, 148, 87, 85, 74, 113, 169, 30, 89, 30, 117, 26, 210, 165, 53, 56, 110, 109, 159, 27, 218, 152, 254, 93, 55, 81, 47, 253, 207, 36, 14, 126, 185, 197, 115, 119, 242, 94, 107, 218, 180, 23, 247, 235, 228, 65, 106, 73, 182, 180, 12, 27, 12, 70, 55, 185, 28, 103, 29, 0, 233, 234, 106, 197, 45, 99, 12, 45, 56, 59, 157, 85, 179, 26, 213, 99, 202, 244, 70, 5, 228, 90, 197, 187, 233, 218, 117, 182, 167, 116, 246, 15, 49, 134, 59, 84, 148, 65, 128, 202, 196, 3, 42, 141, 196, 3, 250, 113, 93, 134, 137, 167, 29, 39, 67, 178, 176, 46, 36, 104, 34, 84, 119, 31, 198, 221, 219, 241, 57, 174, 119, 83, 185, 91, 57, 116, 249, 201, 136, 50, 93, 161, 95, 53, 182, 174, 112, 221, 91, 248, 120, 238, 120, 245, 174, 170, 198, 242, 59, 251, 68, 184, 136, 56, 86, 207, 14, 48, 65, 28, 16, 127, 250, 220, 87, 60, 169, 211, 133, 70, 162, 172, 118, 81, 171, 86, 173, 20, 230, 238, 79, 92, 238, 162, 217, 241, 62, 194, 185, 6, 196, 30, 71, 95, 222, 17, 138, 232, 235, 150, 241, 13, 192, 180, 241, 38, 142, 72, 118, 251, 90, 75, 106, 170, 138, 88, 179, 229, 89, 120, 252, 27, 240, 201, 170, 139, 74, 73, 178, 106, 197, 202, 13, 45, 200, 215, 77, 134, 56, 222, 56, 37, 186, 183, 137, 206, 76, 112, 92, 58, 47, 224, 1, 227, 240, 165, 182, 211, 109, 44, 224, 146, 24, 33, 1, 101, 201, 144, 146, 73, 126, 220, 147, 201, 171, 100, 21, 98, 167, 130, 14, 8, 162, 187, 21, 56, 45, 82, 60, 185, 86, 169, 37, 203, 41, 59, 24, 87, 90, 101, 221, 206, 169, 18, 79, 53, 229, 213, 128, 42, 113, 45, 227, 21, 85, 3, 149, 42, 79, 204, 56, 247, 235, 91, 108, 138, 232, 81, 149, 89, 15, 240, 145, 145, 249, 82, 210, 210, 167, 74, 20, 239, 202, 183, 29, 92, 69, 74, 182, 231, 123, 16, 20, 130, 202, 222, 89, 99, 138, 56, 213, 80, 179, 108, 64, 185, 192, 207, 106, 220, 210, 80, 199, 164, 89, 163, 125, 225, 10, 19, 245, 35, 39, 249, 215, 49, 173, 179, 54, 158, 45, 209, 89, 141, 212, 209, 219, 18, 63, 132, 59, 133, 201, 246, 234, 43, 179, 192, 28, 40, 192, 29, 7, 181, 97, 89, 251, 214, 93, 14, 204, 36, 95, 43, 147, 234, 21, 199, 120, 243, 68, 159, 80, 176, 55, 176, 201, 111, 139, 88, 100, 47, 20, 241, 238, 12, 49, 156, 131, 216, 140, 87, 99, 92, 55, 142, 124, 74, 45, 126, 209, 162, 199, 113, 5, 180, 146, 89, 188, 143, 44, 234, 199, 42, 67, 0, 177, 168, 31, 59, 156, 116, 232, 51, 147, 92, 213, 26, 81, 212, 239, 163, 205, 206, 185, 119, 46, 105, 150, 177, 89, 233, 118, 182, 208, 168, 88, 227, 137, 85, 64, 0, 118, 21, 95, 79, 109, 115, 194, 161, 163, 208, 94, 27, 171, 6, 114, 223, 96, 188, 114, 4, 68, 156, 159, 45, 199, 32, 114, 126, 83, 145, 233, 86, 244, 246, 45, 166, 218, 185, 207, 48, 161, 228, 231, 248, 69, 88, 174, 249, 82, 132, 226, 147, 71, 141, 79, 17, 82, 140, 220, 162, 199, 191, 138, 252, 83, 120, 134, 52, 176, 211, 180, 224, 120, 51, 25, 154, 225, 151, 232, 184, 3, 63, 83, 248, 85, 91, 43, 69, 179, 183, 242, 195, 188, 142, 204, 210, 73, 44, 135, 45, 35, 177, 203, 51, 31, 82, 106, 82, 232, 24, 169, 117, 4, 12, 145, 158, 131, 165, 62, 149, 42, 16, 167, 240, 149, 95, 23, 86, 190, 147, 122, 8, 106, 175, 135, 1, 212, 117, 235, 253, 68, 16, 109, 237, 135, 217, 32, 35, 163, 55, 6, 70, 31, 136, 11, 248, 26, 93, 70, 103, 131, 76, 187, 154, 33, 251, 200, 224, 119, 95, 168, 82, 69, 107, 248, 118, 202, 29, 63, 195, 218, 125, 180, 24, 40, 182, 232, 119, 15, 226, 36, 2, 79, 226, 73, 53, 24, 137, 109, 19, 76, 28, 22, 179, 53, 40, 162, 138, 192, 239, 10, 194, 241, 19, 47, 159, 164, 166, 126, 118, 186, 36, 125, 4, 111, 154, 220, 36, 0, 73, 224, 14, 77, 112, 90, 183, 138, 44, 175, 245, 29, 22, 234, 219, 206, 251, 8, 184, 146, 22, 184, 146, 61, 145, 150, 117, 42, 184, 36, 231, 239, 12, 116, 239, 66, 126, 242, 38, 105, 184, 63, 71, 249, 27, 162, 153, 42, 121, 177, 60, 123, 138, 238, 82, 187, 135, 108, 211, 250, 26, 43, 208, 60, 67, 35, 195, 255, 0, 106, 22, 114, 173, 220, 111, 28, 139, 32, 66, 27, 185, 84, 85, 98, 63, 217, 36, 18, 62, 181, 175, 69, 37, 76, 35, 201, 21, 18, 234, 79, 158, 110, 86, 181, 200, 149, 86, 93, 99, 78, 137, 128, 111, 157, 220, 169, 25, 4, 4, 32, 255, 0, 232, 66, 186, 88, 227, 72, 144, 36, 104, 168, 138, 48, 21, 70, 0, 252, 43, 3, 71, 79, 180, 235, 19, 220, 142, 99, 182, 143, 200, 86, 255, 0, 109, 136, 45, 143, 160, 10, 63, 26, 232, 107, 146, 163, 188, 219, 61, 60, 60, 92, 105, 164, 194, 185, 125, 93, 239, 224, 241, 77, 188, 208, 71, 16, 45, 102, 241, 90, 220, 187, 103, 236, 206, 79, 239, 28, 39, 118, 43, 180, 3, 211, 174, 125, 15, 81, 89, 26, 218, 16, 108, 238, 56, 218, 146, 152, 220, 250, 7, 24, 7, 254, 250, 11, 249, 214, 78, 17, 159, 187, 45, 141, 249, 229, 4, 229, 13, 236, 202, 16, 64, 150, 208, 36, 49, 231, 106, 140, 101, 142, 73, 245, 36, 247, 36, 228, 147, 234, 106, 90, 74, 90, 244, 86, 154, 35, 195, 109, 183, 118, 20, 81, 69, 49, 25, 186, 136, 149, 39, 182, 54, 234, 26, 75, 151, 22, 165, 73, 199, 36, 238, 70, 7, 177, 87, 80, 223, 76, 142, 245, 217, 12, 145, 207, 95, 106, 230, 160, 143, 237, 90, 253, 148, 67, 145, 108, 26, 230, 78, 56, 31, 41, 68, 252, 203, 19, 255, 0, 1, 53, 211, 87, 13, 68, 189, 163, 104, 245, 240, 237, 251, 24, 167, 230, 21, 13, 212, 34, 123, 121, 99, 35, 59, 209, 147, 243, 24, 169, 169, 8, 168, 54, 56, 253, 13, 137, 208, 108, 51, 212, 64, 138, 126, 160, 96, 254, 162, 175, 213, 111, 40, 105, 186, 164, 246, 7, 62, 92, 204, 215, 22, 199, 28, 96, 156, 186, 255, 0, 192, 91, 39, 232, 222, 213, 106, 187, 105, 74, 240, 71, 145, 94, 28, 181, 26, 50, 30, 194, 242, 109, 78, 224, 200, 208, 139, 25, 100, 130, 82, 65, 62, 99, 8, 129, 43, 25, 24, 192, 93, 231, 113, 245, 192, 21, 173, 75, 69, 56, 211, 140, 46, 215, 82, 103, 86, 83, 73, 75, 162, 178, 26, 232, 36, 70, 70, 232, 195, 105, 250, 26, 187, 225, 153, 90, 95, 13, 216, 110, 251, 209, 197, 228, 183, 213, 9, 79, 253, 150, 178, 239, 175, 33, 211, 236, 166, 188, 157, 177, 20, 40, 93, 143, 210, 169, 120, 27, 93, 184, 158, 210, 207, 78, 159, 79, 68, 18, 69, 36, 203, 60, 87, 73, 32, 39, 118, 230, 5, 71, 43, 203, 227, 234, 43, 12, 67, 213, 29, 152, 36, 237, 39, 233, 250, 157, 189, 20, 10, 43, 19, 180, 8, 205, 102, 75, 225, 237, 34, 104, 238, 17, 244, 219, 95, 244, 128, 68, 164, 68, 50, 217, 234, 115, 235, 239, 90, 116, 82, 181, 194, 237, 108, 114, 45, 21, 214, 135, 251, 139, 230, 150, 226, 205, 127, 213, 95, 109, 220, 66, 246, 89, 113, 200, 35, 251, 253, 15, 124, 30, 179, 37, 229, 172, 145, 121, 169, 115, 3, 70, 63, 141, 100, 4, 126, 121, 174, 162, 178, 239, 252, 59, 164, 106, 48, 201, 28, 250, 125, 182, 100, 82, 60, 197, 137, 67, 130, 123, 131, 142, 162, 181, 141, 105, 69, 91, 115, 154, 166, 22, 19, 149, 246, 50, 126, 221, 108, 78, 35, 147, 205, 108, 145, 182, 16, 93, 178, 56, 35, 3, 53, 91, 83, 143, 86, 123, 80, 241, 193, 45, 157, 169, 59, 102, 152, 0, 211, 70, 164, 31, 156, 39, 60, 3, 140, 247, 198, 112, 43, 161, 209, 172, 46, 108, 45, 231, 23, 82, 195, 36, 211, 78, 210, 179, 66, 155, 84, 228, 1, 211, 212, 227, 39, 220, 154, 210, 197, 76, 170, 206, 113, 182, 197, 195, 13, 78, 156, 239, 241, 91, 185, 155, 160, 50, 62, 129, 98, 241, 192, 32, 15, 10, 177, 140, 12, 0, 221, 250, 250, 156, 156, 251, 214, 149, 20, 84, 37, 100, 108, 245, 97, 89, 30, 38, 153, 34, 208, 110, 35, 101, 66, 110, 74, 219, 47, 153, 38, 196, 86, 144, 133, 12, 205, 216, 2, 115, 159, 106, 215, 166, 73, 26, 75, 27, 71, 34, 43, 163, 12, 21, 112, 8, 63, 80, 104, 106, 235, 65, 166, 147, 187, 56, 139, 27, 141, 70, 216, 207, 109, 50, 201, 172, 197, 108, 194, 63, 237, 43, 24, 178, 178, 156, 115, 148, 207, 222, 29, 202, 228, 103, 223, 34, 175, 253, 190, 21, 25, 145, 103, 139, 254, 186, 219, 200, 184, 252, 214, 186, 148, 68, 141, 21, 17, 85, 81, 70, 21, 84, 96, 1, 236, 41, 192, 145, 208, 145, 248, 214, 144, 171, 56, 197, 38, 238, 115, 212, 195, 82, 156, 156, 146, 183, 161, 201, 141, 70, 209, 148, 148, 148, 201, 142, 209, 198, 204, 127, 32, 51, 85, 117, 29, 74, 250, 222, 194, 91, 155, 109, 42, 229, 149, 23, 113, 150, 116, 242, 209, 70, 122, 227, 239, 54, 58, 224, 10, 237, 247, 55, 247, 143, 231, 77, 101, 87, 82, 172, 1, 82, 48, 65, 25, 6, 156, 171, 77, 171, 45, 9, 142, 18, 154, 119, 122, 152, 94, 29, 182, 22, 51, 223, 219, 61, 210, 222, 204, 254, 85, 201, 188, 69, 218, 37, 73, 20, 237, 0, 100, 224, 46, 210, 7, 177, 245, 205, 111, 85, 75, 29, 50, 203, 77, 71, 75, 43, 104, 224, 89, 27, 115, 4, 29, 77, 91, 172, 96, 154, 94, 243, 187, 58, 228, 226, 223, 186, 172, 130, 138, 40, 170, 36, 230, 124, 77, 111, 61, 229, 221, 156, 34, 218, 246, 72, 35, 15, 50, 155, 60, 6, 51, 142, 35, 5, 255, 0, 129, 70, 75, 18, 120, 56, 199, 177, 109, 189, 158, 179, 105, 106, 130, 250, 40, 239, 28, 47, 204, 246, 184, 7, 62, 133, 78, 51, 245, 29, 125, 5, 117, 20, 82, 133, 225, 39, 36, 197, 82, 49, 169, 21, 25, 45, 190, 243, 137, 147, 91, 88, 238, 38, 137, 236, 111, 20, 68, 209, 171, 102, 19, 184, 179, 146, 0, 85, 198, 79, 221, 39, 143, 74, 177, 20, 250, 157, 243, 132, 177, 209, 231, 141, 59, 207, 125, 251, 132, 31, 69, 229, 155, 242, 31, 90, 232, 91, 76, 183, 109, 72, 95, 159, 51, 205, 194, 229, 67, 124, 164, 168, 32, 18, 61, 64, 102, 252, 234, 238, 42, 253, 173, 71, 123, 179, 39, 133, 162, 173, 100, 97, 219, 248, 124, 73, 44, 83, 234, 115, 11, 169, 35, 96, 233, 18, 46, 216, 81, 135, 67, 142, 172, 71, 169, 252, 171, 82, 27, 27, 75, 121, 165, 154, 11, 88, 34, 150, 83, 153, 36, 72, 194, 179, 253, 72, 28, 213, 138, 42, 94, 174, 236, 213, 37, 21, 100, 20, 81, 138, 76, 80, 51, 255, 217}
}
